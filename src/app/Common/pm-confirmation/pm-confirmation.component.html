<div class="card p-2 mb-2">
  <div class="card-body d-flex flex-wrap justify-content-between align-items-center">
    
    <!-- Left section -->
    <div class="d-flex flex-wrap align-items-center">
      <h5 class="card-title mr-3">PM Confirmation</h5>
    
      <p class="text-primary small mb-0 ml-2" *ngIf="this.COMMENT_HISTORY.length > 0">
        (Please Check History)
      </p>
    </div>
    
    <!-- Right section: Buttons -->
    <div class="d-flex flex-wrap gap-2">
      <button 
      
        type="button" 
        class="btn btn-primary btn-sm mr-2"
        >
        History
      </button>
      <button 
        type="button" 
        class="btn btn-success btn-sm mr-2"
        >
        Save
      </button>
      <button 
        type="button" 
        class="btn  btn-outline-primary btn-sm"
       >
        List
      </button>
    </div>

  </div>
</div>

<div class="card mb-3 p-3">
  <div class="row">

    <!-- Issue No -->
    <div class="col-md-3 mb-2">
      <label class="font-weight-bold  small">Issue No.</label>
      <p class="text-secondary small" >
        <!-- {{ "ISSUE_NO" }} -->
12344
      </p>
      <p class="text-secondary small" *ngIf="ISSUE_NO == undefined || ISSUE_NO == '' || ISSUE_NO == null">
        NA
      </p>
    </div>

    <!-- Date -->
    <div class="col-md-3 mb-2">
      <label class="font-weight-bold  small">Date</label>
      <p class="text-secondary small" >
        <!-- {{ "REQUEST_DATE" }} -->
          16/10/2025
      </p>
      <p class="text-secondary small" *ngIf="REQUEST_DATE == undefined || REQUEST_DATE == '' || REQUEST_DATE == null">
        NA
      </p>
    </div>

    <!-- Created By -->
    <div class="col-md-3 mb-2">
      <label class="font-weight-bold  small">Created By</label>
      <p class="text-secondary small">
        <!-- {{ "REQUESTER_NAME" }} -->
          Hemant
      </p>
      <p class="text-secondary small" *ngIf="REQUESTER_NAME == undefined || REQUESTER_NAME == '' || REQUESTER_NAME == null">
        NA
      </p>
    </div>

    <!-- Raised By -->
    <div class="col-md-3 mb-2">
      <label class="font-weight-bold  small">Raised By</label>
      <p class="text-secondary small">
        <!-- {{ "USERNAME" }} -->
          Anand Verma
      </p>
      <p class="text-secondary small" *ngIf="USERNAME == undefined || USERNAME == '' || USERNAME == null">
        NA
      </p>
    </div>

    <!-- Issue Type -->
    <div class="col-md-3 mb-2">
      <label class="font-weight-bold  small">Issue Type</label>
      <p class="text-secondary small">
        <!-- {{ "ISSUE_TYPE_DESC" }} -->
          Test Issue Description
      </p>
      <p class="text-secondary small" *ngIf="ISSUE_TYPE_DESC == undefined || ISSUE_TYPE_DESC == '' || ISSUE_TYPE_DESC == null">
        NA
      </p>
    </div>

    <!-- Priority -->
    <div class="col-md-3 mb-2">
      <label class="font-weight-bold  small">Priority</label>
      <p class="text-secondary small" >
        <!-- {{ "PRIORITY_DESC" }} -->
          Critical
      </p>
      <p class="text-secondary small" *ngIf="PRIORITY_DESC == undefined || PRIORITY_DESC == '' || PRIORITY_DESC == null">
        NA
      </p>
    </div>

    <!-- Module -->
    <div class="col-md-3 mb-2">
      <label class="font-weight-bold  small">Module</label>
      <p class="text-secondary small" >
        <!-- {{ "MODULE_DESC" }} -->
          Test Module Description
      </p>
      <p class="text-secondary small" *ngIf="MODULE_DESC == undefined || MODULE_DESC == '' || MODULE_DESC == null">
        NA
      </p>
    </div>

    <!-- Function -->
    <div class="col-md-3 mb-2">
      <label class="font-weight-bold  small">Function</label>
      <p class="text-secondary small">
        <!-- {{ "FUNCTION_DESC" }} -->
          Test Function Description
      </p>
      <p class="text-secondary small" *ngIf="FUNCTION_DESC == undefined || FUNCTION_DESC == '' || FUNCTION_DESC == null">
        NA
      </p>
    </div>

    <!-- Issue Subject -->
    <div class="col-md-3 mb-2">
      <label class="font-weight-bold  small">Issue Subject</label>
      <p class="text-secondary small" >
        <!-- {{ "ISSUE_SUBJECT" }} -->
          Test Issue Subject
      </p>
      <p class="text-secondary small" *ngIf="ISSUE_SUBJECT == undefined || ISSUE_SUBJECT == '' || ISSUE_SUBJECT == null">
        NA
      </p>
    </div>

    <!-- Reason / Description of Issue/CR -->
    <div class="col-12 mb-2" >
      <label class="font-weight-bold  small" >Reason of CR</label>
      <label class="font-weight-bold  small">Reason of Issue</label>
      <label class="font-weight-bold  small">Description of CR</label>

      <p class="text-secondary small" >
        <!-- {{ "REASON_ISSUE" }} -->
          Reason of Issue
      </p>
      <p class="text-secondary small" *ngIf="REASON_ISSUE == undefined || REASON_ISSUE == '' || REASON_ISSUE == null">NA</p>

      <p class="text-secondary small" >
        <!-- {{ "DESC_ISSUE" }} -->
            Description of Issue
      </p>
      <p class="text-secondary small" *ngIf="DESC_ISSUE == undefined || DESC_ISSUE == '' || DESC_ISSUE == null">NA</p>
    </div>

    <!-- Propose Delivery & Est Hours -->
    <div class="col-md-3 mb-2" *ngIf="PROPOSE_DELIVERY_BY != ''">
      <label class="font-weight-bold  small">Propose New</label>
      <p class="text-secondary small">{{ "PROPOSE_DELIVERY_BY" }}</p>
    </div>
    <div class="col-md-3 mb-2" *ngIf="PROPOSE_HOURS != ''">
      <label class="font-weight-bold  small">Est. Hours</label>
      <p class="text-secondary small">{{ "PROPOSE_HOURS" }} Hr</p>
    </div>

    <!-- Uploaded Document List -->
    <div class="col-md-9 mb-2" *ngIf="DOCUMENT_ATTECHED_LIST.length > 0">
      <label class="font-weight-bold  small">Uploaded Document List</label>
      <table class="table table-sm table-bordered">
        <thead class="thead-light">
          <tr>
            <th>File Name</th>
            <th>Uploaded By</th>
            <th>Date</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of DOCUMENT_ATTECHED_LIST">
            <td>{{ data.FILE_NAME }}</td>
            <td>{{ data.UPLOADEDBY }}</td>
            <td>{{ data.DATE }}</td>
            <td>
              <button *ngIf="['png','jpg','jpeg'].includes(data.EXTENSION)"
                      type="button"
                      class="btn btn-danger btn-sm mr-1"
                    >
                <i class="fa fa-eye"></i>
              </button>
              <button type="button"
                      class="btn btn-danger btn-sm"
                     >
                <i class="fa fa-download"></i>
              </button>
             
                <div>
                  <img [src]="data.DOC_BASE64" style="height: 200px; width: 200px;" />
                </div>
           
            </td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>
</div>

<form [formGroup]="form">

  <!-- Radio Buttons -->
<div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" formControlName="DEVELOPER_STATUS" [value]="'OK'" id="statusOk" name="developerStatus">
    <label class="form-check-label" for="statusOk">Ok</label>
</div>
<div class="form-check form-check-inline">
    <input class="form-check-input" type="radio" formControlName="DEVELOPER_STATUS" [value]="'REJECT'" id="statusReject" name="developerStatus">
    <label class="form-check-label" for="statusReject">Reject</label>
</div>

  <!-- Reason Field (Only visible when OK is selected) -->
  <!-- <div class="form-group mt-3" *ngIf="statusflag">
    <label class="font-weight-bold small">Reason</label>
    <textarea class="form-control" rows="2" formControlName="DEVELOPER_COMMENT" placeholder="Enter Reason"></textarea>
  </div> -->
  <div class="form-group mt-3" *ngIf="form.get('DEVELOPER_STATUS').value === 'OK'">
  <label class="font-weight-bold small">Reason</label>
  <textarea
    class="form-control"
    rows="2"
    formControlName="DEVELOPER_COMMENT"
    placeholder="Enter Reason"
  ></textarea>
</div>


  <!-- All Other Fields (Only visible when REJECT is selected) -->
  <div *ngIf="DEVELOPER_STATUS_SELECTED === 'REJECT'">

    <!-- Delivery By, Est Hours, Resolution -->
    <div class="form-row mb-3">
      <div class="col-md-4">
        <label class="font-weight-bold small">Delivery By</label>
        <input type="date" class="form-control" formControlName="DELIVERY_BY">
      </div>

      <div class="col-md-4">
        <label class="font-weight-bold small">Est. Hours <span class="text-danger">*</span></label>
        <input type="number" class="form-control" formControlName="EST_HOURS" placeholder="Enter Est. Hours" maxlength="3">
      </div>

      <div class="col-md-4">
        <label class="font-weight-bold small">Resolution <span class="text-danger">*</span></label>
        <select class="form-control" formControlName="RESOLUTION_CODE">
          <option *ngFor="let res of RESOLUTION_LIST" [value]="res.RESOLUTION_CODE">{{ res.RESOLUTION_NAME }}</option>
        </select>
      </div>
    </div>

    <!-- Developer Explanation & File Upload -->
    <div class="form-row">
      <div class="col-md-6 mb-3">
        <label class="font-weight-bold small">Developer Explanation <span class="text-danger">*</span></label>
        <textarea class="form-control" rows="4" formControlName="DEVELOPER_COMMENT" placeholder="Enter Developer Explanation"></textarea>
      </div>

      <div class="col-md-6 mb-3">
        <input type="file" #fileInput2 hidden (change)="onFileSelectedUploadDocument($event)" accept=".jpg,.png,.jpeg,.pdf,.xlsx,.docx" multiple>
        <button type="button" class="btn btn-primary mb-2" (click)="fileInput2.click()">
          <i class="pi pi-paperclip mr-2"></i>Add
        </button>

        <!-- Uploaded Documents Table -->
        <table class="table table-sm table-bordered">
          <thead>
            <tr>
              <th>File Name</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let data of DEVELOPER_DOCUMENT_LIST; let i = index">
              <td>{{ data.FILE_NAME }}</td>
              <td>
                <button *ngIf="['png','jpg','jpeg'].includes(data.FILE_EXTENSION)" type="button" class="btn btn-info btn-sm mr-1">
                  <i class="pi pi-eye"></i>
                </button>
                <button type="button" class="btn btn-danger btn-sm" (click)="removeUploadDoc(data)">
                  <i class="pi pi-trash"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

  </div>

</form>

